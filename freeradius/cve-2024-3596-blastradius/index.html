<!DOCTYPE html>
<html lang="zh-TW">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width">
<meta name="theme-color" content="#222"><meta name="generator" content="Hexo 7.3.0">

  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">
  <meta name="google-site-verification" content="po7J7mJmPnFy18jHjTQq1NrsexKsVfZYl0zy84hP08s">

<link rel="stylesheet" href="/css/main.css">



<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.6.0/css/all.min.css" integrity="sha256-5eIC48iZUHmSlSUz9XtjRyK2mzQkHScZY1WdMaoz74E=" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/fancyapps-ui/5.0.31/fancybox/fancybox.css" integrity="sha256-gkQVf8UKZgQ0HyuxL/VnacadJ+D2Kox2TCEBuNQg5+w=" crossorigin="anonymous">

<script class="next-config" data-name="main" type="application/json">{"hostname":"silent198214.github.io","root":"/","images":"/images","scheme":"Gemini","darkmode":false,"version":"8.21.1","exturl":true,"sidebar":{"position":"right","width_expanded":320,"width_dual_column":240,"display":"post","padding":18,"offset":12},"hljswrap":false,"copycode":{"enable":true,"style":null},"fold":{"enable":false,"height":500},"bookmark":{"enable":false,"color":"#222","save":"auto"},"mediumzoom":false,"lazyload":true,"pangu":false,"comments":{"style":"tabs","active":"utterances","storage":false,"lazyload":true,"nav":null,"activeClass":"utterances"},"stickytabs":false,"motion":{"enable":false,"async":false,"duration":200,"transition":{"menu_item":"fadeInDown","post_block":"fadeIn","post_header":"fadeInDown","post_body":"fadeInDown","coll_header":"fadeInLeft","sidebar":"fadeInUp"}},"prism":false,"i18n":{"placeholder":"搜尋...","empty":"我們無法找到任何有關 ${query} 的搜索結果","hits_time":"找到 ${hits} 個搜索結果（用時 ${time} 毫秒）","hits":"找到 ${hits} 個搜索結果"}}</script><script src="/js/config.js"></script>

    <meta name="description" content="這個問題源自於名為 BlastRADIUS (CVE-2024-3596) 的 RADIUS 協定漏洞，只要是在不安全的網路環境裡面使用非 EAP 驗證框架搭配 RADIUS over UDP 協定，就容易遭受中間人攻擊">
<meta property="og:type" content="article">
<meta property="og:title" content="FreeRADIUS 的 BlastRADIUS 弱點修補">
<meta property="og:url" content="https://silent198214.github.io/freeradius/cve-2024-3596-blastradius/">
<meta property="og:site_name" content="山姆的 IT 日常">
<meta property="og:description" content="這個問題源自於名為 BlastRADIUS (CVE-2024-3596) 的 RADIUS 協定漏洞，只要是在不安全的網路環境裡面使用非 EAP 驗證框架搭配 RADIUS over UDP 協定，就容易遭受中間人攻擊">
<meta property="og:locale" content="zh_TW">
<meta property="article:published_time" content="2024-10-03T02:00:00.000Z">
<meta property="article:modified_time" content="2024-10-03T02:00:00.000Z">
<meta property="article:author" content="Sam Chen">
<meta property="article:tag" content="CVE-2024-3596">
<meta property="article:tag" content="BlastRADIUS">
<meta property="article:tag" content="FreeRADIUS">
<meta name="twitter:card" content="summary">


<link rel="canonical" href="https://silent198214.github.io/freeradius/cve-2024-3596-blastradius/">


<script class="next-config" data-name="page" type="application/json">{"sidebar":"","isHome":false,"isPost":true,"lang":"zh-TW","comments":true,"permalink":"https://silent198214.github.io/freeradius/cve-2024-3596-blastradius/","path":"freeradius/cve-2024-3596-blastradius/","title":"FreeRADIUS 的 BlastRADIUS 弱點修補"}</script>

<script class="next-config" data-name="calendar" type="application/json">""</script>
<title>FreeRADIUS 的 BlastRADIUS 弱點修補 | 山姆的 IT 日常</title>
  
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-8K41M2BW4P"></script>
  <script class="next-config" data-name="google_analytics" type="application/json">{"tracking_id":"G-8K41M2BW4P","only_pageview":false,"measure_protocol_api_secret":null}</script>
  <script src="/js/third-party/analytics/google-analytics.js"></script>



  <script defer src='https://static.cloudflareinsights.com/beacon.min.js' data-cf-beacon='{&quot;token&quot;: &quot;376b1ae59fa7423797c15d59469ee4e4&quot;}'></script>





  <noscript>
    <link rel="stylesheet" href="/css/noscript.css">
  </noscript>
</head>

<body itemscope itemtype="http://schema.org/WebPage">
  <div class="headband"></div>

  <main class="main">
    <div class="column">
      <header class="header" itemscope itemtype="http://schema.org/WPHeader"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="切換導航欄" role="button">
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <i class="logo-line"></i>
      <p class="site-title">山姆的 IT 日常</p>
      <i class="logo-line"></i>
    </a>
      <p class="site-subtitle" itemprop="description">Networking / Devops</p>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger" aria-label="搜尋" role="button">
    </div>
  </div>
</div>



<nav class="site-nav">
  <ul class="main-menu menu"><li class="menu-item menu-item-home"><a href="/" rel="section"><i class="fa fa-home fa-fw"></i>首頁</a></li><li class="menu-item menu-item-tags"><a href="/tags/" rel="section"><i class="fa fa-tags fa-fw"></i>標籤</a></li><li class="menu-item menu-item-categories"><a href="/categories/" rel="section"><i class="fa fa-th fa-fw"></i>分類</a></li><li class="menu-item menu-item-archives"><a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>歸檔</a></li>
  </ul>
</nav>




</header>
        
  
  <aside class="sidebar">

    <div class="sidebar-inner sidebar-nav-active sidebar-toc-active">
      <ul class="sidebar-nav">
        <li class="sidebar-nav-toc">
          文章目錄
        </li>
        <li class="sidebar-nav-overview">
          本站概要
        </li>
      </ul>

      <div class="sidebar-panel-container">
        <!--noindex-->
        <div class="post-toc-wrap sidebar-panel">
            <div class="post-toc animated"><ol class="nav"><li class="nav-item nav-level-3"><a class="nav-link" href="#Enable-Security-function"><span class="nav-number">1.</span> <span class="nav-text">Enable Security function</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Workaround-from-2-0-0-to-3-2-4"><span class="nav-number">2.</span> <span class="nav-text">Workaround from 2.0.0 to 3.2.4</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Prior-to-2-0-0"><span class="nav-number">3.</span> <span class="nav-text">Prior to 2.0.0</span></a></li></ol></div>
        </div>
        <!--/noindex-->

        <div class="site-overview-wrap sidebar-panel">
          <div class="site-author animated" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <img class="site-author-image" itemprop="image" alt="Sam Chen"
      src="https://github.com/silent198214.png">
  <p class="site-author-name" itemprop="name">Sam Chen</p>
  <div class="site-description" itemprop="description">努力的走在 IT 這條漫長的道路上</div>
</div>
<div class="site-state-wrap animated">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
        <a href="/archives/">
          <span class="site-state-item-count">35</span>
          <span class="site-state-item-name">文章</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
          <a href="/categories/">
        <span class="site-state-item-count">9</span>
        <span class="site-state-item-name">分類</span></a>
      </div>
      <div class="site-state-item site-state-tags">
          <a href="/tags/">
        <span class="site-state-item-count">54</span>
        <span class="site-state-item-name">標籤</span></a>
      </div>
  </nav>
</div>
  <div class="links-of-author animated">
      <span class="links-of-author-item">
        <span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL3NpbGVudDE5ODIxNA==" title="GitHub → https:&#x2F;&#x2F;github.com&#x2F;silent198214"><i class="fab fa-github fa-lg fa-fw"></i>GitHub</span>
      </span>
      <span class="links-of-author-item">
        <span class="exturl" data-url="aHR0cHM6Ly93d3cubGlua2VkaW4uY29tL2luL3NhbTE5ODIv" title="Linkedin → https:&#x2F;&#x2F;www.linkedin.com&#x2F;in&#x2F;sam1982&#x2F;"><i class="fab fa-linkedin-in fa-fw"></i>Linkedin</span>
      </span>
  </div>

        </div>
      </div>
    </div>

    
  </aside>


    </div>

    <div class="main-inner post posts-expand">


  


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="zh-TW">
    <link itemprop="mainEntityOfPage" href="https://silent198214.github.io/freeradius/cve-2024-3596-blastradius/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="https://github.com/silent198214.png">
      <meta itemprop="name" content="Sam Chen">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="山姆的 IT 日常">
      <meta itemprop="description" content="努力的走在 IT 這條漫長的道路上">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="FreeRADIUS 的 BlastRADIUS 弱點修補 | 山姆的 IT 日常">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          FreeRADIUS 的 BlastRADIUS 弱點修補
        </h1>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">發表於</span>

      <time title="創建時間：2024-10-03 10:00:00" itemprop="dateCreated datePublished" datetime="2024-10-03T10:00:00+08:00">2024-10-03</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">分類於</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/freeradius/" itemprop="url" rel="index"><span itemprop="name">freeradius</span></a>
        </span>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody"><p>這個問題源自於名為 <code>BlastRADIUS</code> (CVE-2024-3596) 的 RADIUS 協定漏洞，只要是在不安全的網路環境裡面使用非 EAP 驗證框架搭配 RADIUS over UDP 協定，就容易遭受中間人攻擊</p>
<span id="more"></span>
<p>因為我們是使用 FreeRADIUS，所以在官方的 <span class="exturl" data-url="aHR0cHM6Ly93d3cuZnJlZXJhZGl1cy5vcmcvc2VjdXJpdHkv">Security Note<i class="fa fa-external-link-alt"></i></span> 裡面也有提到這個訊息。</p>
<p>然而文中也提到，他們其實早在 1998 年就注意到也嘗試的修正</p>
<blockquote>
<p>The truly sad thing is that we’ve been trying to fix this issue since 1998. The first public record we can find of anyone complaining about this issue is by Alan DeKok (FreeRADIUS founder) in 1998. Alan further tried to fix it in RFC 5080, Section 2.2.2, in 2007.</p>
</blockquote>
<p>當然最好的辦法就是將你的 RADIUS Server 升級到可支援 <code>RadSec</code> (RADIUS over TCP) 這個協定並啟用他，只不過這件事情非同小可，整個通訊架構將會有所改變，勢必需要長期規劃。</p>
<div class="note warning"><p>需要特別注意以下的設定，因為關係到各個環境的舊設備不支援發送 <code>Message-Authenticator</code> 時，會導致驗證失敗。</p>
<p>因為早期的設備並沒有強制發送 <code>Message-Authenticator</code>，當 FreeRADIUS 啟動這個參數，只要 <code>Access-Request</code> 裡面沒有包含 Message-Authenticator 這個 attribute，一律都會 reject，所以要特別注意環境中是否有這樣的設備。</p>
<p>如果平常有開啟 detail 紀錄 log，可以從中檢視一下。</p>
</div>
<h3 id="Enable-Security-function">Enable Security function</h3>
<p>另一個方式，如果你的 FreeRADIUS 版本是 3.2.5 以上，你可以在 <code>radiusd.conf</code> 啟用新的 security function</p>
<figure class="highlight toml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">security &#123;</span><br><span class="line">    ...</span><br><span class="line">    <span class="attr">require_message_authenticator</span> = auto</span><br><span class="line">    <span class="attr">limit_proxy_state</span> = auto</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="Workaround-from-2-0-0-to-3-2-4">Workaround from 2.0.0 to 3.2.4</h3>
<p>若版本位於 2.0.0 到 3.2.4 之間，可以使用 workaround 的做法</p>
<p>修改 <code>clients.conf</code>，在 client section 裡面加入 <strong>require_message_authenticator = yes</strong> ，用來檢驗 <code>NAS</code> 送過來的 Access-Request 必須包含 <code>Message-Authenticator</code> 這個 attribute</p>
<p>然後在 <code>sites-enabled</code> 這個資料夾裡面修改你有用到的 virtual-server (例如 <code>default</code>)，找到 authorize section 加入</p>
<figure class="highlight toml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">authorize &#123;</span><br><span class="line">	if (!EAP-Message) &#123;</span><br><span class="line">		update reply &#123;</span><br><span class="line">			Message-Authenticator := 0x00</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br></pre></td></tr></table></figure>
<p>這樣就可以讓所有 <code>Access-*</code> 的封包裡面都會包含 <code>Message-Authenticator</code> 這個 attribute</p>
<h3 id="Prior-to-2-0-0">Prior to 2.0.0</h3>
<p>如果你的版本是 2.0.0 以前，唯一的建議還是打掉重裝比較好。</p>

    </div>

    
    
    

    <footer class="post-footer">
          

<div class="post-copyright">
<ul>
  <li class="post-copyright-author">
      <strong>本文作者： </strong>Sam Chen
  </li>
  <li class="post-copyright-link">
      <strong>文章連結：</strong>
      <a href="https://silent198214.github.io/freeradius/cve-2024-3596-blastradius/" title="FreeRADIUS 的 BlastRADIUS 弱點修補">https://silent198214.github.io/freeradius/cve-2024-3596-blastradius/</a>
  </li>
  <li class="post-copyright-license">
      <strong>版權聲明： </strong>本網誌所有文章除特別聲明外，均採用 <span class="exturl" data-url="aHR0cHM6Ly9jcmVhdGl2ZWNvbW1vbnMub3JnL2xpY2Vuc2VzL2J5LW5jLXNhLzQuMC8="><i class="fab fa-fw fa-creative-commons"></i>BY-NC-SA</span> 許可協議。轉載請註明出處！
  </li>
</ul>
</div>

          <div class="post-tags">
              <a href="/tags/CVE-2024-3596/" rel="tag"># CVE-2024-3596</a>
              <a href="/tags/BlastRADIUS/" rel="tag"># BlastRADIUS</a>
              <a href="/tags/FreeRADIUS/" rel="tag"># FreeRADIUS</a>
          </div>

        

          <div class="post-nav">
            <div class="post-nav-item">
                <a href="/freeradius/eduroam-compliance-intro/" rel="prev" title="在 TANet 環境中導入 eduroam 前需要留意的事情">
                  <i class="fa fa-angle-left"></i> 在 TANet 環境中導入 eduroam 前需要留意的事情
                </a>
            </div>
            <div class="post-nav-item">
                <a href="/fortinet/tip-radius-invalid-secret/" rel="next" title="FortiGate radius gui response invalid secret for the server">
                  FortiGate radius gui response invalid secret for the server <i class="fa fa-angle-right"></i>
                </a>
            </div>
          </div>
    </footer>
  </article>
</div>






    <div class="comments utterances-container"></div>
</div>
  </main>

  <footer class="footer">
    <div class="footer-inner">

  <div class="copyright">
    &copy; 2015 – 
    <span itemprop="copyrightYear">2025</span>
    <span class="with-love">
      <i class="fa fa-heart"></i>
    </span>
    <span class="author" itemprop="copyrightHolder">Sam Chen</span>
  </div>
  <div class="powered-by">由 <span class="exturl" data-url="aHR0cHM6Ly9oZXhvLmlv">Hexo</span> & <span class="exturl" data-url="aHR0cHM6Ly90aGVtZS1uZXh0LmpzLm9yZw==">NexT.Gemini</span> 強力驅動
  </div>

    </div>
  </footer>

  
  <div class="toggle sidebar-toggle" role="button">
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
  </div>
  <div class="sidebar-dimmer"></div>
  <div class="back-to-top" role="button" aria-label="回到頂端">
    <i class="fa fa-arrow-up fa-lg"></i>
    <span>0%</span>
  </div>

<noscript>
  <div class="noscript-warning">Theme NexT works best with JavaScript enabled</div>
</noscript>


  
  <script src="https://cdnjs.cloudflare.com/ajax/libs/animejs/3.2.1/anime.min.js" integrity="sha256-XL2inqUJaslATFnHdJOi9GfQ60on8Wx1C2H8DYiN1xY=" crossorigin="anonymous"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/fancyapps-ui/5.0.31/fancybox/fancybox.umd.js" integrity="sha256-a+H7FYzJv6oU2hfsfDGM2Ohw/cR9v+hPfxHCLdmCrE8=" crossorigin="anonymous"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/lozad.js/1.16.0/lozad.min.js" integrity="sha256-mOFREFhqmHeQbXpK2lp4nA3qooVgACfh88fpJftLBbc=" crossorigin="anonymous"></script>
<script src="/js/comments.js"></script><script src="/js/utils.js"></script><script src="/js/sidebar.js"></script><script src="/js/next-boot.js"></script>

  



  <script src="/js/third-party/fancybox.js"></script>



  




  <script src="https://cdnjs.cloudflare.com/ajax/libs/quicklink/2.3.0/quicklink.umd.js" integrity="sha256-yvJQOINiH9fWemHn0vCA5lsHWJaHs6/ZmO+1Ft04SvM=" crossorigin="anonymous"></script>
  <script class="next-config" data-name="quicklink" type="application/json">{"enable":true,"home":true,"archive":true,"delay":true,"timeout":3000,"priority":true,"url":"https://silent198214.github.io/freeradius/cve-2024-3596-blastradius/"}</script>
  <script src="/js/third-party/quicklink.js"></script>
<script class="next-config" data-name="utterances" type="application/json">{"enable":true,"repo":"silent198214/silent198214.github.io","issue_term":"pathname","theme":"github-light"}</script>
<script src="/js/third-party/comments/utterances.js"></script>

</body>
</html>
